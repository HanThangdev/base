stages:
  - deploy

cache:
  key: &global_cache_node_mods
    files:
      - package-lock.json
  paths:
    - node_modules/
  policy: pull

install:
  image: ...
  stage: .pre # always first, no matter if it is listed in stages
  cache:
    key:
      files:
        - package-lock.json
    paths:
      - node_modules/
    when: on_success
    policy: pull-push
  script:
    - npm ci --cache .npm --prefer-offline

include:
  - project: "BAPSoftware/outsource/bapsw.s0142.goemon/goemon-devops"
    ref: main
    file: "gitlab-templates/goemon-web-user/dev.gitlab-ci.yml"
